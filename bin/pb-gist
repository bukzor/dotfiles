#!/usr/bin/python3
from urllib.request import urlopen
import json
import sys

files = sys.argv[1:] or ['-']

data = {
    "public": True,
    "files": {},
}

for fname in files:
    if fname == '-':
        f = sys.stdin
    else:
        f = open(fname)

    fname = fname.replace('/', 'â§¸')
    data['files'][fname] = {
        'type': 'text/plain',
        'content': f.read(),
    }

r = urlopen(
    'https://api.github.com/gists',
    json.dumps(data).encode('UTF-8'),
)

response = json.loads(r.read())
print(response['html_url'])
